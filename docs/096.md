# ä½¿ç”¨ AvatarCLIP åœ¨æ¸å˜ä¸­åˆ›å»ºåŠ¨ç”» 3D è§’è‰²(ç¬¬ 1 éƒ¨åˆ†)

> åŸæ–‡ï¼š<https://blog.paperspace.com/animated-3d-characters-with-avatarclip-part-1/>

æ·±åº¦å­¦ä¹ æœ€å¤§çš„æ‰¿è¯ºä¹‹ä¸€æ˜¯ç”Ÿæˆåª’ä½“çš„å‡ºç°ã€‚è¿™å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯å› ä¸ºç”Ÿæˆåª’ä½“æ˜¯ç›®å‰è¿™äº›æ¡†æ¶æä¾›çš„æœ€å®¹æ˜“èµšé’±çš„è§£å†³æ–¹æ¡ˆä¹‹ä¸€ã€‚ç”Ÿæˆçš„åª’ä½“ï¼Œæ— è®ºæ˜¯è§†é¢‘ã€éŸ³é¢‘ã€æ–‡æœ¬è¿˜æ˜¯å…¶ä»–æ ¼å¼ï¼Œéƒ½æœ‰å¯èƒ½è¢«è½¬æ¢ä¸ºç”¨äºå„ç§ä¸åŒç›®çš„çš„å†…å®¹ã€‚é€šè¿‡åˆ©ç”¨è¿™ç§åˆ›é€ åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç›¸å…³ä»»åŠ¡ä¸Šè‡ªåŠ¨åŒ–å¾ˆå¤§ä¸€éƒ¨åˆ†åˆ›ä½œè¿‡ç¨‹ï¼Œè€Œä¸”æŠ€æœ¯è¿˜æ²¡æœ‰è¾¾åˆ°è¿™ç§ç¨‹åº¦ï¼Œå³è¿™äº›å†…å®¹æœ‰æ—¶ç”šè‡³æ— æ³•ä¸çœŸæ­£çš„äººç±»æ¼”å‘˜åˆ¶ä½œçš„å†…å®¹åŒºåˆ†å¼€æ¥ã€‚å¯¹äº NLP å’Œè®¡ç®—æœºè§†è§‰ç›¸å…³çš„ä»»åŠ¡æ¥è¯´å°¤å…¶å¦‚æ­¤ã€‚

åŠ¨ç”»æ˜¯å°šæœªè¢«å½»åº•æ”¹å˜çš„é¢†åŸŸä¹‹ä¸€ã€‚æ·±åº¦å­¦ä¹ å¹¶æ²¡æœ‰è§¦åŠåŠ¨ç”»ï¼Œå› ä¸ºä¸€äº›æœ‰è¿›å–å¿ƒçš„å·¥ç¨‹å¸ˆå·²ç»æƒ³å‡ºäº†[æ–°é¢–çš„æ–¹æ³•æ¥è¾“å…¥æŒ‡ä»¤ä»¥åˆ¶ä½œç°æœ‰ 3D äººç‰©](https://github.com/sebastianstarke/AI4Animation) &çš„åŠ¨ç”»ï¼Œç›¸åï¼Œå…¶ä»–äººå·²ç»åˆ›å»ºäº†ç”Ÿæˆ[æ–°é¢–çš„æ–¹æ³•ï¼Œé™æ€ 3D æ¨¡å‹çš„çº¹ç†](https://openaccess.thecvf.com/content_CVPRW_2019/papers/3D-WidDGET/Amit_Raj_Learning_to_Generate_Textures_on_3D_Meshes_CVPRW_2019_paper.pdf)ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä½¿ç”¨ä¸€ä¸ªç®€å•çš„æ–‡æœ¬æç¤ºæ¥ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„ 3D åŠ¨ç”»äººç‰©çš„æƒ³æ³•ç›´åˆ°ç°åœ¨è¿˜æ˜¯ä¸€ä¸ªæœªæ¥çš„æ‰¿è¯ºã€‚

æ‰¿æ‹…è¿™é¡¹ä»»åŠ¡çš„ä»¤äººå…´å¥‹çš„æ–°é¡¹ç›®æ˜¯ AvatarCLIPã€‚ç”±æ´ªã€ã€ã€è”¡ä¸­æ˜‚ã€é›·é˜³å’Œæ’°å†™çš„[åŸå§‹è®ºæ–‡](https://arxiv.org/pdf/2205.08535.pdf)å±•ç¤ºäº†ä»–ä»¬åˆ›æ–°çš„æ–°æ–¹æ³•ï¼Œå³æ ¹æ®æ–‡æœ¬æç¤ºç”Ÿæˆç²—ç³™çš„ SMPL(å¸¦çš®è‚¤çš„å¤šäººçº¿æ€§)æ¨¡å‹äººç‰©ã€çº¹ç†å’Œé€ å‹ï¼Œç„¶åä»…ä½¿ç”¨æ–‡æœ¬æç¤ºå°†å®ƒåˆ¶ä½œæˆåŠ¨ç”»ä»¥æ‰§è¡Œä¸€äº›è¿åŠ¨ã€‚å®ƒé€šè¿‡ä¸ OpenAI çš„ CLIP(ä¸€ç§æ›´èªæ˜çš„æ¶æ„)çš„å·§å¦™é›†æˆæ¥å®ç°è¿™ä¸€ç‚¹ã€‚

åœ¨ AvatarCLIP çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†æ£€æŸ¥ä»–ä»¬ç”Ÿæˆåˆå§‹ SMPL æ¨¡å‹çš„æ–¹æ³•ï¼Œå¹¶ä½¿ç”¨ CLIP å¯¹å…¶è¿›è¡Œçº¹ç†å¤„ç†ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†å±•ç¤ºå¦‚ä½•åœ¨æ¸å˜ç¬”è®°æœ¬ä¸­ä½¿ç”¨è¿™ç§æŠ€æœ¯ï¼Œä»ä¸€ä¸ªç¤ºä¾‹é…ç½®ä¸­ç”Ÿæˆä¸€ä¸ªé™æ€æ¨¡å‹:æ¥è‡ª One Punch Man çš„ Saitamaã€‚åœ¨ç¬¬ 2 éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ç ”ç©¶åŠ¨ç”»äººç‰©æ¥å®Œæˆå®Œæ•´çš„ AvatarCLIP ç®¡é“ã€‚

# AvatarCLIP

![](img/a3cb6c97cf6d5b4ad4702ef222d7852c.png)

[Source](https://arxiv.org/pdf/2205.08535.pdf)

AvatarCLIP ä»¥ä¸€ç³»åˆ—æ˜ç¡®å®šä¹‰çš„æ­¥éª¤å·¥ä½œï¼Œè¿™äº›æ­¥éª¤å…±åŒå½¢æˆäº†ä¸€ä¸ªç®¡é“ï¼Œä½¿å°è¯´åˆ›ä½œå……æ»¡æ´»åŠ›ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨ä¸Šé¢çš„ç¤ºä¾‹å›¾åƒä¸­æ‰€çœ‹åˆ°çš„ï¼Œè¿™åŸºæœ¬ä¸Šåˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼Œé¦–å…ˆåˆ›å»ºåˆå§‹å›¾å½¢ï¼Œç„¶åå¯¹å…¶è¿›è¡Œçº¹ç†å¤„ç†å’Œé›•åˆ»ï¼Œä»¥åŒ¹é…æç¤ºä¸­çš„æè¿°ç¬¦å…ƒç´ ï¼Œæœ€å Marching Cube ç®—æ³•å°†åº”ç”¨è¾“å…¥çš„è¿åŠ¨æç¤ºæ¥åˆ¶ä½œå›¾å½¢çš„åŠ¨ç”»ã€‚æˆ‘ä»¬å°†åœ¨æœ¬æ–‡ä¸­æ£€æŸ¥å®Œæ•´çš„ç®¡é“ï¼Œä½†æ˜¯å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒåŠ¨ç”»äººç‰©çš„ä»£ç æ­£åœ¨ç§¯æå¼€å‘ä¸­ã€‚å› æ­¤ï¼Œä»£ç çš„åŠ¨ç”»éƒ¨åˆ†å°†åœ¨å‘å¸ƒæ—¶è¢«è¦†ç›–ã€‚æ•¬è¯·å…³æ³¨ç¬¬ 2 éƒ¨åˆ†ï¼Œåœ¨ Twitter @ paper space ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚

## å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„

[https://www.youtube.com/embed/-l2ZMeoASGY?feature=oembed](https://www.youtube.com/embed/-l2ZMeoASGY?feature=oembed)

åœ¨ä¸Šé¢çš„è§†é¢‘ä¸­ï¼Œæ¥è‡ªé¡¹ç›®ä½œè€…ï¼Œä»–ä»¬å±•ç¤ºäº†æ–‡æœ¬é©±åŠ¨çš„å¤´åƒç”Ÿæˆå’ŒåŠ¨ç”»çš„ä¸“æœ‰ç•Œé¢ã€‚æŒ‰ç…§æˆ‘ä»¬ä¸Šé¢æè¿°çš„æ­¥éª¤ï¼Œä»–ä»¬å±•ç¤ºäº†å„ç§å„æ ·çš„è§’è‰²å¯ä»¥è¢«å»ºæ¨¡å’ŒåŠ¨ç”»åŒ–ã€‚æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹è¿™æ˜¯æ€ä¹ˆå›äº‹ã€‚

é¦–å…ˆï¼ŒAvatarCLIP ç”Ÿæˆä¸€ä¸ªç²—ç•¥çš„å½¢çŠ¶ç½‘æ ¼ï¼Œç”¨ä½œåŸºçº¿å›¾å½¢ã€‚ç½‘æ ¼æ˜¯æè¿° 3D å¯¹è±¡å½¢çŠ¶çš„é¡¶ç‚¹ã€è¾¹å’Œé¢çš„é›†åˆã€‚å‰ªè£æ¨¡å‹é‡‡ç”¨å½¢çŠ¶æ–‡æœ¬æç¤ºæ¥ç¡®å®šå›¾å½¢åº”ä½¿ç”¨çš„åŸºç¡€å½¢çŠ¶ã€‚è¿™ä¸ªåŸºçº¿å›¾æ˜¯æˆ‘ä»¬çš„èµ·ç‚¹ï¼Œä½†å®ƒæ˜¯ç°è‰²çš„ï¼Œæ²¡æœ‰ä»€ä¹ˆç‰¹ç‚¹ã€‚åŸºäºå¤–è§‚å’Œå½¢çŠ¶æ–‡æœ¬æç¤ºï¼Œåœ¨ä¸‹ä¸€é˜¶æ®µåº”ç”¨çº¹ç†å’Œé›•åˆ»ã€‚åŒæ—¶ï¼Œå‰ªè¾‘æ¨¡å‹è§£é‡Šè¿åŠ¨æ–‡æœ¬æç¤ºï¼Œä»¥æ‰¾åˆ°äººç‰©å°†è·Ÿéšçš„è¿åŠ¨çš„æè¿°æ€§å…ƒç´ ã€‚ç„¶åï¼Œå®ƒä¼šæ ¹æ®è¿™äº›è¿åŠ¨æç¤ºä¸ºæ¨¡å‹ç”Ÿæˆä¸€ç³»åˆ—é€‚å½“çš„å‚è€ƒå§¿åŠ¿ã€‚AvatarCLIP ç„¶åé€šè¿‡åœ¨å‚è€ƒå§¿åŠ¿çš„æ—¶é—´è½´ä¸Šç§»åŠ¨ç°åœ¨æœ‰çº¹ç†çš„äººç‰©æ¥é›†æˆè¿™ä¸¤ä¸ªç®¡é“çš„åŠŸèƒ½ï¼Œä»è€Œäº§ç”Ÿäººç‰©çš„è¿è´¯åŠ¨ç”»ã€‚

## ä½“ç³»ç»“æ„

![](img/6ff18512d1b11eee9f275ce6c704cc45.png)

An overview of the pipeline from the original paper - [Source](https://arxiv.org/pdf/2205.08535.pdf)

ç°åœ¨æˆ‘ä»¬å·²ç»äº†è§£äº† AvatarCLIP çš„æƒ…å†µï¼Œè®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹è¿™ä¸ªç®¡é“ï¼Œä»¥ä¾¿æ›´å¥½åœ°äº†è§£é›†æˆæ¨¡å‹ç®¡é“æ˜¯å¦‚ä½•å®ç°çš„ã€‚æˆ‘ä»¬éœ€è¦ç†è§£çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ï¼Œè¿™å¤„äºä¸¤ä¸ªåŸºæœ¬é˜¶æ®µ:åŒ–èº«ç”Ÿæˆå’ŒåŠ¨ä½œç”Ÿæˆã€‚è®©æˆ‘ä»¬æ›´ä»”ç»†åœ°çœ‹çœ‹æ¯ä¸€ä¸ªé˜¶æ®µï¼Œçœ‹çœ‹æ¯ä¸€ä¸ªé˜¶æ®µçš„ç”Ÿæˆæ˜¯å¦‚ä½•å®ç°çš„ã€‚(åœ¨ä»£ç æ¼”ç¤ºéƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†åœ¨æœ¬ç³»åˆ—çš„ç¬¬ä¸€éƒ¨åˆ†ä¸­è®¨è®ºå‰è€…ã€‚ç¬¬ 2 éƒ¨åˆ†å°†ä»‹ç»è¿åŠ¨ç”Ÿæˆã€‚)

AvatarCLIP çš„æ€»ä½“ç›®æ ‡æ˜¯åˆ›å»ºä¸€ä¸ªâ€œé›¶é•œå¤´æ–‡æœ¬é©±åŠ¨çš„ 3D åŒ–èº«ç”Ÿæˆå’ŒåŠ¨ç”»ã€‚â€æ¢å¥è¯è¯´ï¼Œä»–ä»¬éœ€è¦è¯¥æ¨¡å‹èƒ½å¤Ÿå¤„ç†è¶…å‡ºå…¶è®­ç»ƒèŒƒå¼èŒƒå›´çš„æç¤ºï¼Œå¹¶å…·æœ‰è¶³å¤Ÿçš„çµæ´»æ€§æ¥å¤„ç†æœªçŸ¥æœ¯è¯­ã€‚å¹¸è¿çš„æ˜¯ï¼ŒCLIP å¾ˆå¥½åœ°è¦†ç›–äº†æ–‡æœ¬éƒ¨åˆ†ã€‚

ä¸ºæ­¤ï¼Œä»–ä»¬ä»æ–‡æœ¬å½¢å¼çš„è‡ªç„¶è¯­è¨€è¾“å…¥å…¥æ‰‹ï¼Œå…¶ä¸­ text = { **t** shapeï¼Œ **t** appï¼Œ **t** motion}ã€‚è¿™æ˜¯ä¸‰ä¸ªç‹¬ç«‹çš„æ–‡æœ¬æç¤ºï¼Œå¯¹åº”äºæˆ‘ä»¬å¸Œæœ›ç”¨äºæœ€ç»ˆåŠ¨ç”»çš„æ‰€éœ€èº«ä½“å½¢çŠ¶ã€å¤–è§‚å’Œè¿åŠ¨çš„æè¿°ã€‚

### ç²—ç•¥çš„åŒ–èº«ç”Ÿæˆ

![](img/2fef4db74b038c854f1ec6eec1ae1226.png)

[Source](https://arxiv.org/pdf/2205.08535.pdf)

å‰ä¸¤ä¸ªæç¤º **t** shape å’Œ **t** app åˆ†åˆ«ç”¨äºåœ¨åŠ¨ç”»ä¹‹å‰å¯¹ SMPL æ¨¡å‹è¿›è¡Œçº¹ç†å’Œé›•åˆ»ã€‚ä¸ºæ­¤ï¼Œä»£ç é¦–å…ˆé€šè¿‡å½¢çŠ¶ VAE ç”Ÿæˆä¸€ä¸ªç²—ç•¥çš„ SMPL å›¾å½¢ï¼Œè¯¥å›¾å½¢è¢«è®­ç»ƒä¸ºæ„é€ ä¸€ä¸ªç”¨äºå‰ªè¾‘å¼•å¯¼æŸ¥è¯¢çš„ä»£ç ç°¿ï¼Œä»¥è·å¾—è¾“å…¥æ–‡æœ¬ **t** å½¢çŠ¶çš„æœ€ä½³åŒ¹é…ã€‚ç°åœ¨æˆ‘ä»¬æœ‰äº†ç²—ç•¥çš„ã€æœªåŠ çº¹ç†çš„å›¾å½¢ç½‘æ ¼ M *t* ä½œä¸ºæˆ‘ä»¬çš„åŸºçº¿ã€‚

### ç²¾ç»†çº¹ç†å’Œé›•åˆ»

![](img/9671307a485fa18b1ba46563150f6397.png)

[Source](https://arxiv.org/pdf/2205.08535.pdf)

ç„¶åï¼Œä½œè€…é€‰æ‹©é€šè¿‡å°†è¿›ä¸€æ­¥ç€è‰²å’Œé›•åˆ»çš„æ­¥éª¤åˆ†ç¦»ä¸ºä¸¤ä¸ªé˜¶æ®µçš„è¿‡ç¨‹ï¼Œæ¥åŠ é€Ÿäººç‰©ä»ç²—ç³™åˆ°ç²¾ç»†ç»†èŠ‚çš„ä¼˜åŒ–ã€‚é¦–å…ˆï¼ŒM *t* ç”¨äºä¼˜åŒ–éšæœºåˆå§‹åŒ–çš„ NeuS ç½‘ç»œ nã€‚è¿™åˆ›å»ºäº† M *t çš„éšå¼ç­‰ä»·è¡¨ç¤ºã€‚*NeuS ç½‘ç»œç”±ä¸¤ä¸ª MLP å­ç½‘ç»œç»„æˆã€‚SDF ç½‘ç»œğ‘“(ğ‘)å°†æŸä¸ªç‚¹ğ‘ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¾“å‡ºåˆ°å…¶æœ€è¿‘è¡¨é¢çš„å¸¦ç¬¦å·è·ç¦»ã€‚é¢œè‰²ç½‘ç»œğ‘(ğ‘)ä»¥æŸä¸ªç‚¹ğ‘ä¸ºè¾“å…¥ï¼Œè¾“å‡ºè¯¥ç‚¹çš„é¢œè‰²ã€‚â€([æ¥æº](https://arxiv.org/pdf/2205.08535.pdf))è¿™äº›æ‰§è¡Œä¸€ä¸ªåˆæ­¥çš„ï¼Œæ›´å°çš„é‡æ–°ç€è‰²å’Œé›•å¡‘çš„æ•°å­—ã€‚

![](img/e382c58cd616e6c3701fae7f284bbf87.png)

[Source](https://arxiv.org/pdf/2205.08535.pdf)

åœ¨ä¸‹ä¸€é˜¶æ®µï¼Œå°†è¿›è¡Œç²¾ç»†çš„ç»†èŠ‚è®¾è®¡å’Œé›•åˆ»ã€‚ä¸ºäº†åœ¨ç€è‰²æˆ–é›•åˆ»èƒ½åŠ›ä¸Šä¸é­å—ä»»ä½•æŸå¤±ï¼Œä½œè€…ä¸ºåˆå§‹åŒ–çš„éšå¼ 3D åŒ–èº«é™„åŠ äº†é¢å¤–çš„é¢œè‰²ç½‘ç»œç”¨äºçº¹ç†ç”Ÿæˆ(è§ä¸Šæ–‡)ã€‚æ¯ä¸ªé¢œè‰²ç½‘ç»œéƒ½ä¸ SDF ç½‘ç»œä¸€èµ·å·¥ä½œï¼ŒåŒæ—¶æ‰§è¡Œä¸åŒçš„ä»»åŠ¡:åŸå§‹çš„ *c(p)* é¢œè‰²ç½‘ç»œå’Œ *f(p)* SDF ç½‘ç»œç”¨äºä½¿ç”¨æ¥è‡ªå‰ªè¾‘æ–‡æœ¬ç¼–ç å™¨çš„æŒ‡å¯¼æ¥é‡å»ºç½‘æ ¼ M *t* ä»¥åŒ¹é… **t** app æç¤ºï¼Œç„¶å Cc(p)ã€é™„åŠ ç½‘ç»œå’Œ SDF ç½‘ç»œ *f(p)* åœ¨å‰ªè¾‘ç¼–ç å›¾åƒçš„æŒ‡å¯¼ä¸‹æ‰§è¡Œæ›´ç²¾ç»†çš„ç»†èŠ‚å¤„ç†ã€‚ä½¿ç”¨å‰ªè¾‘å¼•å¯¼æŸå¤±ï¼Œè¯¥ç³»ç»Ÿå°†ä¸€èµ·ç”Ÿæˆåœ¨å½¢çŠ¶å’Œç»†èŠ‚æ–¹é¢è¿‘ä¼¼äºè¾“å…¥æç¤ºçš„ç²¾ç»†ç»†èŠ‚å›¾å½¢ï¼Œä½†æ˜¯æ²¡æœ‰å§¿æ€ã€‚

### å§¿åŠ¿ç”Ÿæˆ

![](img/b5059555b50880615b6928819ba88e8c.png)

[Source](https://arxiv.org/pdf/2205.08535.pdf)

ä¸ºäº†å°†äººç‰©åŠ¨ç”»åŒ–ä¸ºå§¿åŠ¿ï¼Œæˆ‘ä»¬éœ€è¦å›åˆ°ç”Ÿæˆè¿‡ç¨‹çš„å¼€å§‹ã€‚åœ¨è¿›è¡Œä»»ä½•é€ å‹æˆ–ç€è‰²ä¹‹å‰ï¼Œä»–ä»¬é¦–å…ˆæœ‰ä¸€ä¸ªåä¸º VPoser çš„é¢„è®­ç»ƒ VAEï¼Œä½¿ç”¨ AMASS æ•°æ®é›†ä¸ºæç¤ºå»ºç«‹ä¸€ä¸ªä»£ç ç°¿ã€‚è¿™æ˜¯ä¸ºäº†å°½å¯èƒ½å¤šåœ°æ”¶é›† SMPL æ¨¡ç‰¹ä½“å‹çš„æè¿°æ€§ä½“å‹ã€‚è¿™ä¸ªä»£ç ç°¿ç„¶åè¢«ç”¨æ¥æŒ‡å¯¼ä¸€ç³»åˆ—çš„å€™é€‰å§¿æ€äº§ç”Ÿå‰ªè¾‘ã€‚è¿™äº›å§¿æ€ç„¶åè¢«ç”¨äºä½¿ç”¨è¿åŠ¨å…ˆéªŒä»¥å€™é€‰å§¿æ€ä½œä¸ºå‚è€ƒçš„è¿åŠ¨åºåˆ—ç”Ÿæˆã€‚

æµæ°´çº¿ä½¿ç”¨æ–‡æœ¬æè¿° **t** motionï¼Œå…¶ä¸­æ¥è‡ªç æœ¬çš„æ¯ä¸ªå§¿æ€ç‰¹å¾ğ‘“ğ¼ç”¨äºè®¡ç®—ä¸æ–‡æœ¬ç‰¹å¾ğ‘“ğ‘‡çš„ç›¸ä¼¼æ€§ï¼Œè¯¥ç›¸ä¼¼æ€§ç”¨äºé€‰æ‹© Top-K ä¸ªæ¡ç›®ä½œä¸ºå€™é€‰å§¿æ€ã€‚è¿™äº›å§¿æ€ç„¶åè¢«é€‰æ‹©ä½œä¸ºè¦ä¼ é€’åˆ°è¿åŠ¨åŠ¨ç”»é˜¶æ®µçš„å€™é€‰å§¿æ€é›†ã€‚

### ä»ä¸€ç³»åˆ—å§¿åŠ¿åˆ°åŠ¨ç”»

![](img/367a99f1d1a88eb7d7f25e38f0384864.png)

[Source](https://arxiv.org/pdf/2205.08535.pdf)

ä¸ºäº†æ•æ‰æˆ‘ä»¬å¯ä»¥è½¬ç§»åˆ°æˆ‘ä»¬çš„ç½‘æ ¼åºåˆ—ä¸­çš„å§¿æ€ï¼Œè¿åŠ¨ VAE é¦–å…ˆè¢«è®­ç»ƒæ¥æ•æ‰äººç±»çš„è¿åŠ¨å…ˆéªŒã€‚éšç€é¢„è®­ç»ƒçš„ VAE ç°åœ¨è¯†åˆ« SMPL æ¨¡å‹ä¸­çš„ç±»äººè¿åŠ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å€™é€‰å§¿æ€ğ‘†ä½œä¸ºå‚è€ƒæ¥ä¼˜åŒ–è¿åŠ¨ VAE çš„æ½œåœ¨ä»£ç ã€‚ä¸ºæ­¤ï¼Œä½¿ç”¨ä¸‰ä¸ªæŸå¤±é¡¹æ¥ä¼˜åŒ–æˆ‘ä»¬çš„è¿åŠ¨ï¼Œä»¥æ›´æ¥è¿‘åœ°åŒ¹é…æç¤ºã€‚ç¬¬ä¸€ä¸ªï¼Œå§¿åŠ¿æŸå¤±ï¼Œä½œä¸ºåŸºçº¿ã€‚è¿™ç§æŸå¤±å¯ä»¥å•ç‹¬ç”¨æ¥é‡å»ºåŸå§‹å§¿åŠ¿ï¼Œä½†ä½œè€…è®¤ä¸ºè¿™ç»™è¿åŠ¨å¸¦æ¥äº†ä¸€ç§çœ‹èµ·æ¥ä¸å¯æ€è®®çš„å¹³æ»‘ã€‚ä¸ºäº†è¿›ä¸€æ­¥ä¼˜åŒ–è¿™ä¸ªæŸå¤±å‡½æ•°ï¼Œä»–ä»¬å¼•å…¥äº†å¦å¤–ä¸¤ä¸ªæŸå¤±å‡½æ•°æ¥è°ƒæ•´æŸå¤±å§¿æ€ã€‚å¢é‡æŸå¤±è¡¡é‡ç›¸é‚»å§¿åŠ¿ä¹‹é—´çš„å·®å¼‚ï¼Œå¹¶ç”¨äºå½±å“è¿åŠ¨çš„å¼ºåº¦ã€‚æœ€åï¼Œä¸¢å¤±å‰ªè¾‘æµ‹é‡ **t** è¿åŠ¨ä¸­çš„æè¿°ä¸åºåˆ—ä¸­æ¯ä¸ªå§¿æ€ä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚æ€»çš„æ¥è¯´ï¼Œè¿™äº›æŸå¤±å‡½æ•°ä¼˜åŒ–äº†å§¿æ€åºåˆ—ä»¥ç»™æˆ‘ä»¬åºåˆ—Î¸ï¼Œå…¶å¯ç”¨äºè¡¨ç¤ºç²—ç•¥æ¨¡å‹å§¿æ€çš„åŠ¨ç”»æ­¥éª¤ã€‚

### æŠŠæ‰€æœ‰çš„æ”¾åœ¨ä¸€èµ·

å› æ­¤ï¼Œè¾“å‡ºç”±ä¸¤éƒ¨åˆ†ç»„æˆã€‚é¦–å…ˆï¼Œä¸€ä¸ªç”¨ç½‘æ ¼è¡¨ç¤ºçš„å¯åŠ¨ç”»åŒ–çš„ 3D åŒ–èº«ï¼ŒM **t** ã€‚è¿™åœ¨æ–‡ä¸­è¡¨ç¤ºä¸ºğ‘€ = {ğ‘‰ã€ğ¹ã€ğ¶}ï¼Œå…¶ä¸­ğ‘‰æ˜¯é¡¶ç‚¹ï¼Œğ¹ä»£è¡¨é¢ï¼Œğ¶ä»£è¡¨é¡¶ç‚¹é¢œè‰²ã€‚ç„¶åï¼Œç¬¬äºŒè¾“å‡ºæ˜¯åŒ…å«æœŸæœ›è¿åŠ¨çš„å§¿æ€åºåˆ—ã€‚å½“ç»„åˆåœ¨ä¸€èµ·æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªå®Œå…¨æˆå½¢å’Œæœ‰çº¹ç†çš„äººç‰©ï¼Œç”Ÿæˆå¯¹åº”äº **t** å½¢çŠ¶å’Œ **t** åº”ç”¨ç¨‹åºï¼Œé€šè¿‡ä» **t** åŠ¨ä½œè§£é‡Šçš„å§¿åŠ¿çš„æ—¶é—´çº¿ç§»åŠ¨ã€‚

ç°åœ¨è®©æˆ‘ä»¬åœ¨ä¸‹ä¸€èŠ‚çœ‹çœ‹å¦‚ä½•ç”¨ä»£ç è·å¾—ç¬¬ä¸€ä¸ªè¾“å‡ºã€‚

## AvatarCLIP ä»£ç æ¼”ç¤º

è¦åœ¨ Gradient ä¸Šè¿è¡Œè¿™ä¸ªï¼Œé¦–å…ˆåœ¨ PyTorch è¿è¡Œæ—¶ä¸Šå¯åŠ¨ä¸€ä¸ª Gradient ç¬”è®°æœ¬ï¼Œä½¿ç”¨æ‚¨å–œæ¬¢çš„ä»»ä½• GPU(å°½ç®¡å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå³ä½¿åœ¨ 100-80GB çš„è®¡ç®—æœºä¸Šï¼Œè¿™ä¹Ÿå°†æ˜¯ä¸€ä¸ªæ¼«é•¿çš„è®­ç»ƒåºåˆ—)ã€‚ç„¶åï¼Œæ‚¨å°†å¸Œæœ›é€šè¿‡åˆ‡æ¢é«˜çº§é€‰é¡¹å¼€å…³å¹¶å°†å…¶ç²˜è´´åˆ°å­—æ®µä¸­ï¼Œä½¿è¯¥ URL æˆä¸ºå·¥ä½œåŒº URLã€‚ç„¶ååˆ›å»ºç¬”è®°æœ¬ã€‚

åœ¨è¿™ä¸ªæ¼”ç¤ºä¸­ï¼Œæˆ‘ä»¬å°†ä¸»è¦æ¼”ç¤ºå¤´åƒç”Ÿæˆçš„ç»†èŠ‚å’Œé›•åˆ»é˜¶æ®µæ˜¯å¦‚ä½•è¿›è¡Œçš„ã€‚

### è®¾ç½®ç¯å¢ƒ

ä¸€æ—¦æ‚¨çš„ç¬”è®°æœ¬å¯åŠ¨ï¼Œæ‰“å¼€å¹¶åœ¨ç»ˆç«¯ä¸­è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼Œå¼€å§‹è®¾ç½®æˆ‘ä»¬çš„ç¯å¢ƒã€‚ç¬”è®°æœ¬ä¸Šä¹Ÿæœ‰æè¿°ã€‚

```py
# Needed repos
git clone https://github.com/gradient-ai/AvatarCLIP.git
git clone https://github.com/hongfz16/neural_renderer.git

# First set of requirements, courtesy of author team
pip install -r AvatarCLIP/requirements.txt

# additional installs for Gradient
pip install -U numpy # their requirements.txt has an outdated NumPy install you can fix instead if so desired.
pip install scikit-image

# install neural renderer as package on Gradient
pip install git+https://github.com/hongfz16/neural_renderer

# complete their set up process
%cd neural_renderer
python3 setup.py install
%cd ..

# final housekeeping and setup to display video later
apt-get update && apt-get install libgl1
apt install ffmpeg
```

æ¥ä¸‹æ¥ï¼Œå» https://smpl.is.tue.mpg.de/index.html æ³¨å†Œã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬ä¸èƒ½åˆ†å‘ SMPL æ¨¡å‹åŒ…ç»™ä½ ï¼Œä½†ä½ å¯ä»¥é€šè¿‡æ³¨å†Œå¹¶åŒæ„ä»–ä»¬çš„è®¸å¯æ¥å…è´¹ä¸‹è½½ã€‚ç„¶åï¼Œå» https://smpl.is.tue.mpg.de/download.php ä¸‹è½½ SMPL_python_v.1.1.1.zipã€‚ä¸€æ—¦ä½ åœ¨æœ¬åœ°æœºå™¨ä¸Šæœ‰äº†å®ƒï¼Œä½ å°±å¯ä»¥æŠŠå®ƒä¸Šä¼ åˆ°ç¬”è®°æœ¬ï¼Œç„¶ååœ¨ä½ çš„ç»ˆç«¯ä¸Šè¿è¡Œä¸‹é¢çš„ä»£ç è§£å‹å®ƒ:

```py
unzip SMPL_python_v.1.1.1.zip
```

### è¿›å£

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å¯¼å…¥çš„åŒ…æ¥è¿è¡Œæ¼”ç¤ºã€‚

```py
# If you not here, make sure the next line is run somewhere in the notebook prior to this 
# %cd /content/AvatarCLIP/AvatarGen/AppearanceGen

# imports
import os
import time
import logging
import argparse
import random
import numpy as np
import cv2 as cv
import trimesh
import torch
import torch.nn.functional as F
from torchvision import transforms
from torch.utils.tensorboard import SummaryWriter
from shutil import copyfile
from icecream import ic
from tqdm import tqdm
from pyhocon import ConfigFactory
from models.dataset import Dataset
from models.dataset import SMPL_Dataset
from models.fields import RenderingNetwork, SDFNetwork, SingleVarianceNetwork, NeRF
from models.renderer import NeuSRenderer
from models.utils import lookat, random_eye, random_at, render_one_batch, batch_rodrigues
from models.utils import sphere_coord, random_eye_normal, rgb2hsv, differentiable_histogram
from models.utils import my_lbs, readOBJ
import clip
from smplx import build_layer
import imageio

to8b = lambda x : (255*np.clip(x,0,1)).astype(np.uint8)
from main import Runner
```

### è¾“å…¥å¤–è§‚æè¿°

åœ¨ä¸‹ä¸€ä¸ªå•å…ƒä¸­ï¼Œæˆ‘ä»¬å¼€å§‹è¾“å…¥æç¤ºï¼Œå¹¶å¯¹ç²—ç•¥æ¨¡å‹ç”Ÿæˆè¿›è¡Œè°ƒæ•´ã€‚ç‰¹åˆ«æ˜¯ï¼Œè¿™æ˜¯æˆ‘ä»¬è¾“å…¥ **t** app æ¥ä¿®æ”¹æˆ‘ä»¬çš„ç²—ç•¥æ•°å­—çš„åœ°æ–¹ã€‚ç›®å‰ï¼Œè¿™æ˜¯ä¸ºæ‰€æœ‰è¾“å…¥è®¾ç½®çš„ä¸­æ€§å›¾å½¢ç½‘æ ¼ï¼Œç„¶åç»™å®ƒä»¬ç€è‰²ä»¥åŒ¹é… **t** app æç¤ºã€‚

æ‚¨å¯ä»¥é€šè¿‡ç¼–è¾‘ AppearanceDescription å’Œ conf_path å˜é‡ä¸­çš„å€¼æ¥è°ƒæ•´æ­£åœ¨åˆ¶ä½œçš„å›¾å½¢ç±»å‹ã€‚å®ƒä»¬è¢«é»˜è®¤è®¾ç½®ä¸ºè¿è¡Œç¤ºä¾‹ Iron Man é…ç½®ã€‚é€šè¿‡æŸ¥çœ‹`confs/examples/`ä¸­çš„ç¤ºä¾‹ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°æ›´å¤šé…ç½®ï¼Œå¹¶æ›´æ”¹æ¯ä¸ªå˜é‡çš„å­—ç¬¦ä¸²ä»¥ä¸æ›´æ”¹ç›¸å¯¹åº”ã€‚åœ¨è¿™ä¸ªæ¼”ç¤ºä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¼«ç”»ä½œè€… One çš„å¼€åˆ›æ€§ä½œå“ã€Šä¸€æ‹³äººã€‹ä¸­çš„ç¦ç‰ã€‚

```py
#@title Input Appearance Description (e.g. Iron Man)
AppearanceDescription = "Iron Man" #@param {type:"string"}

torch.set_default_tensor_type('torch.cuda.FloatTensor')
FORMAT = "[%(filename)s:%(lineno)s - %(funcName)20s() ] %(message)s"
logging.basicConfig(level=logging.INFO, format=FORMAT)
conf_path = 'confs/examples_small/example.conf'
f = open(conf_path)
conf_text = f.read()
f.close()
conf_text = conf_text.replace('{TOREPLACE}', AppearanceDescription)
# print(conf_text)
conf = ConfigFactory.parse_string(conf_text)
print("Prompt: {}".format(conf.get_string('clip.prompt')))
print("Face Prompt: {}".format(conf.get_string('clip.face_prompt')))
print("Back Prompt: {}".format(conf.get_string('clip.back_prompt')))
```

### è¯¦ç»†æè¿°å’Œé›•åˆ»ç²—ç³™ç½‘æ ¼

ä¸ºäº†å¼€å§‹ç”Ÿæˆè¿‡ç¨‹ï¼Œæˆ‘ä»¬é¦–å…ˆç”¨æœ€åä¸€ä¸ªå•å…ƒæ ¼ä¸­è®¾ç½®çš„å˜é‡ä½œä¸ºå‚æ•°å®ä¾‹åŒ– Runner å¯¹è±¡ã€‚ç„¶åï¼Œå®ƒä¸ºæˆ‘ä»¬åˆå§‹åŒ–å‰ªè¾‘ ViT-B/32 æ¨¡å‹ï¼Œå¹¶å¸¦å‡º SMPL æ–‡ä»¶ç”¨äºçº¹ç†å’Œå½¢çŠ¶ã€‚æœ€åï¼Œ`train_clip()`åˆå§‹åŒ–å¹¶è¿è¡Œç”Ÿæˆè¿‡ç¨‹ã€‚

> æ³¨æ„:å¦‚æœä½ æƒ³æ”¹å˜è®­ç»ƒçš„è¿­ä»£æ¬¡æ•°ï¼Œä»é»˜è®¤çš„ 30000ï¼Œä½ éœ€è¦åˆ°`/AvatarCLIP/AvatarGen/AppearanceGen/main.py`å»æ”¹å˜ç¬¬ 50 è¡Œçš„å˜é‡åˆ°ä½ æƒ³è¦çš„å€¼ã€‚

```py
#@title Start the Generation!
runner = Runner(conf_path, 'train_clip', 'smpl', False, True, conf)
runner.init_clip()
runner.init_smpl()
runner.train_clip()
```

å•å…ƒå®Œæˆè¿è¡Œåï¼Œæ‚¨å¯ä»¥è½¬åˆ°`/AvatarCLIP/AvatarGen/AppearanceGen/exp/smpl/examples`è·å–æ¯å¼ ç…§ç‰‡ä¹‹é—´é—´éš” 100 ä¸ªè®­ç»ƒæ­¥éª¤çš„æ¨¡å‹é™æ­¢å›¾åƒã€‚è¿™å¯ä»¥ä¸ä¸‹é¢çš„ä»£ç å•å…ƒä¸€èµ·ä½¿ç”¨æ¥åˆ›å»ºä¸€ä¸ªå¾ˆå¥½çš„è§†é¢‘ï¼Œå±•ç¤ºæ•°å­—åœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­æ˜¯å¦‚ä½•å˜åŒ–çš„ã€‚

```py
#@title Generate a Video of Optimization Process (RGB)

import os
from tqdm import tqdm
import numpy as np
from IPython import display
from PIL import Image
from base64 import b64encode

image_folder = 'exp/smpl/examples/Saitama/validations_extra_fine'
image_fname = os.listdir(image_folder)
image_fname = sorted(image_fname)
image_fname = [os.path.join(image_folder, f) for f in image_fname]

init_frame = 1
last_frame = len(image_fname)
min_fps = 10
max_fps = 60
total_frames = last_frame - init_frame

length = 15 #Desired time of the video in seconds

frames = []
for i in range(init_frame, last_frame): #
    frames.append(Image.open(image_fname[i]))

#fps = last_frame/10
fps = np.clip(total_frames/length,min_fps,max_fps)

from subprocess import Popen, PIPE
p = Popen(['ffmpeg', '-y', '-f', 'image2pipe', '-vcodec', 'png', '-r', str(fps), '-i', '-', '-vcodec', 'libx264', '-r', str(fps), '-pix_fmt', 'yuv420p', '-crf', '17', '-preset', 'veryslow', 'video.mp4'], stdin=PIPE)
for im in tqdm(frames):
    im.save(p.stdin, 'PNG')
p.stdin.close()
p.wait()
mp4 = open('video.mp4','rb').read()
data_url = "data:video/mp4;base64," + b64encode(mp4).decode()

display.HTML("""
<video width=400 controls>
      <source src="%s" type="video/mp4">

""" % data_url)
```

å½“è¿™ä¸€åˆ‡éƒ½å®Œæˆåï¼Œä½ åº”è¯¥ä¼šçœ‹åˆ°å¦‚ä¸‹è§†é¢‘ã€‚ä¸ä½œè€…ä½¿ç”¨çš„ç¤ºä¾‹ç›¸æ¯”ï¼Œè¿™åœ¨è´¨é‡ä¸Šæœ‰ç‚¹ä½ï¼Œä½†è¾“å…¥çš„ç²¾ç¥æ˜¾ç„¶åœ¨ä¸€ä¸ªè¯¦ç»†çš„åº„å›­ä¸­è¢«æ•è·:

<https://blog.paperspace.com/content/media/2022/06/saitama.mp4>



# ç»“æŸè¯­

è¿™æ˜¯æœ¬ç³»åˆ—çš„ç¬¬ä¸€éƒ¨åˆ†ã€‚åœ¨è¿™ç¯‡åšæ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† AvatarCLIP æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå¹¶å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨å®ƒä»æä¾›çš„æ˜“äºä½¿ç”¨çš„é…ç½®ä¸­ç”Ÿæˆæœ‰çº¹ç†çš„é›•å¡‘å›¾å½¢ã€‚åœ¨ AvatarCLIP ç³»åˆ—çš„ä¸‹ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†æ›´æ·±å…¥åœ°ç ”ç©¶æ¨¡å‹çš„åŠ¨ç”»éƒ¨åˆ†ã€‚

è¯·åŠ¡å¿…è®¿é—® AvatarCLIP ä¸Šçš„åŸå§‹[å›è´­](https://github.com/hongfz16/AvatarCLIP/)çš„[é¡¹ç›®é¡µé¢](https://hongfz16.github.io/projects/AvatarCLIP.html)ã€‚è¿™æ˜¯ä¸€ä¸ªå…¨æ–°çš„å›è´­ï¼Œå› æ­¤é¢„è®¡ 2022 å¹´ä¸‹åŠå¹´å°†ä¼šæœ‰æ›´å¤šçš„å˜åŒ–å’Œæ”¹è¿›ï¼Œè¿›ä¸€æ­¥æ”¹å–„è¿™ä¸€ç‚¹ã€‚

æ„Ÿè°¢é˜…è¯»ã€‚